<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/Personal-Blog/2.8bee379ac3150e408f97.css">@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:url(/Personal-Blog/static/merriweather-400-l-8796b7875d52e9cb9b280211e8d3f82d.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:url(/Personal-Blog/static/montserrat-900-l-5751237264c0468be0d48ad1cea75b90.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}body{--pink:#ffa7c4;background-color:var(--bg)}body.light{--bg:#fff;--header:var(--pink);--textNormal:#222;--textTitle:#222;--textLink:#d23669;--hr:rgba(0,0,0,0.2);--inlineCode-bg:rgba(255,229,100,0.2);--inlineCode-text:#1a1a1a}body.dark{-webkit-font-smoothing:antialiased;--bg:#282c35;--header:#fff;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#fff;--textLink:var(--pink);--hr:hsla(0,0%,100%,0.2);--inlineCode-bg:#373c49;--inlineCode-text:#e6e6e6}body:lang(ar) article,body:lang(fa) article{direction:rtl}body:lang(ar) .language-text,body:lang(ar) article .translations,body:lang(ar) article pre,body:lang(fa) .language-text,body:lang(fa) article .translations,body:lang(fa) article pre{direction:ltr}body:lang(ar) .language-text,body:lang(fa) .language-text{display:inline-block}body:lang(ar) blockquote,body:lang(fa) blockquote{border-left:unset;border-right:.32813rem solid rgba(0,0,0,.9);padding-right:1.42188rem;padding-left:unset;margin-left:.75rem;margin-right:-1.75rem}body:lang(fa) article,body:lang(fa) header>h1{font-family:Vazir}body:lang(ar) article,body:lang(ar) header>h1{font-family:Cairo,sans-serif}body:lang(ko) article,body:lang(ko) header{word-break:keep-all}code[class*=language-],pre[class*=language-]{color:#fff;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;-webkit-font-feature-settings:normal;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:hsla(0,0%,100%,.15)}:not(pre)>code[class*=language-]{border-radius:.3em;background:var(--inlineCode-bg);color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;display:block;padding-right:1em;padding-left:1.25em;border-left:.25em solid #ffa7c4}.gatsby-highlight,.gatsby-highlight-code-line{margin-right:-1.3125rem;margin-left:-1.3125rem}.gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}.react-toggle{touch-action:pan-x;display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.react-toggle-screenreader-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle-track{width:50px;height:24px;padding:0;border-radius:30px;background-color:#0f1114;transition:all .2s ease}.react-toggle-track-check{position:absolute;width:17px;height:17px;left:5px;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0;opacity:0;transition:opacity .25s ease}.react-toggle--checked .react-toggle-track-check,.react-toggle-track-x{opacity:1;transition:opacity .25s ease}.react-toggle-track-x{position:absolute;width:17px;height:17px;right:5px;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0}.react-toggle--checked .react-toggle-track-x{opacity:0}.react-toggle-thumb{position:absolute;top:1px;left:1px;width:22px;height:22px;border-radius:50%;background-color:#fafafa;box-sizing:border-box;transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;-webkit-transform:translateX(0);transform:translateX(0)}.react-toggle--checked .react-toggle-thumb{-webkit-transform:translateX(26px);transform:translateX(26px);border-color:#19ab27}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 2px 3px #ffa7c4}.react-toggle:active .react-toggle-thumb{box-shadow:0 0 5px 5px #ffa7c4}</style><style data-href="/Personal-Blog/component---src-templates-blog-post-js.77da55083c18bdb7fbef.css">@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:url(/Personal-Blog/static/merriweather-400-i-l-9a3ea56a5f449980432ace5972181ef6.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:url(/Personal-Blog/static/merriweather-700-l-e24e02bb044cb07539a3a6bd12348d14.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:url(/Personal-Blog/static/merriweather-700-i-l-ad085ede31afcc5585ff34869b1cd029.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}.formkit-form *{box-sizing:border-box}.formkit-form legend{border:none;font-size:inherit;margin-bottom:10px;padding:0;position:relative;display:table}.formkit-form fieldset{border:0;padding:.01em 0 0;margin:0;min-width:0}.formkit-form body:not(:-moz-handler-blocked) fieldset{display:table-cell}.formkit-form p{color:inherit;font-size:inherit;font-weight:inherit}.formkit-form[data-format="slide in"],.formkit-form[data-format=modal]{display:none}.formkit-form .formkit-checkboxes,.formkit-form .formkit-input,.formkit-form .formkit-select{width:100%}.formkit-form .formkit-button,.formkit-form .formkit-submit{border:0;border-radius:5px;color:#fff;cursor:pointer;display:inline-block;text-align:center;font-size:15px;font-weight:500;margin-bottom:15px;overflow:hidden;padding:0;position:relative;vertical-align:middle}.formkit-form .formkit-button:focus,.formkit-form .formkit-button:hover,.formkit-form .formkit-submit:focus,.formkit-form .formkit-submit:hover{outline:none}.formkit-form .formkit-button:focus>span,.formkit-form .formkit-button:hover>span,.formkit-form .formkit-submit:focus>span,.formkit-form .formkit-submit:hover>span{background-color:#dc658d}.formkit-form .formkit-button>span,.formkit-form .formkit-submit>span{display:block;transition:all .3s ease-in-out;padding:12px 24px}.formkit-form .formkit-input{background:#fff;font-size:15px;padding:12px;border:1px solid #e3e3e3;flex:1 0 auto;line-height:1.4;margin:0;transition:border-color .3s ease-out}.formkit-form .formkit-input:focus{outline:none;border-color:#1677be;transition:border-color .3s ease}.formkit-form .formkit-input::-webkit-input-placeholder{color:#848585}.formkit-form .formkit-input:-ms-input-placeholder{color:#848585}.formkit-form .formkit-input::-ms-input-placeholder{color:#848585}.formkit-form .formkit-input::placeholder{color:#848585}.formkit-form [data-group=dropdown]{position:relative;display:inline-block;width:100%}.formkit-form [data-group=dropdown]:before{content:"";top:calc(50% - 2.5px);right:10px;position:absolute;pointer-events:none;border-color:#4f4f4f transparent transparent;border-style:solid;border-width:6px 6px 0;height:0;width:0;z-index:999}.formkit-form [data-group=dropdown] select{height:auto;width:100%;cursor:pointer;color:#333;line-height:1.4;margin-bottom:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-size:15px;padding:12px 25px 12px 12px;border:1px solid #e3e3e3;background:#fff}.formkit-form [data-group=dropdown] select:focus{outline:none}.formkit-form [data-group=checkboxes]{text-align:left;margin:0}.formkit-form [data-group=checkboxes] [data-group=checkbox]{margin-bottom:10px}.formkit-form [data-group=checkboxes] [data-group=checkbox] *{cursor:pointer}.formkit-form [data-group=checkboxes] [data-group=checkbox]:last-of-type{margin-bottom:0}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]{display:none}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]+label:after{content:none}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]:checked+label:after{border-color:#fff;content:""}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]:checked+label:before{background:#10bf7a;border-color:#10bf7a}.formkit-form [data-group=checkboxes] [data-group=checkbox] label{position:relative;display:inline-block;padding-left:28px}.formkit-form [data-group=checkboxes] [data-group=checkbox] label:after,.formkit-form [data-group=checkboxes] [data-group=checkbox] label:before{position:absolute;content:"";display:inline-block}.formkit-form [data-group=checkboxes] [data-group=checkbox] label:before{height:16px;width:16px;border:1px solid #e3e3e3;background:#fff;left:0;top:3px}.formkit-form [data-group=checkboxes] [data-group=checkbox] label:after{height:4px;width:8px;border-left:2px solid #4d4d4d;border-bottom:2px solid #4d4d4d;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);left:4px;top:8px}.formkit-form .formkit-alert{background:#f9fafb;border:1px solid #e3e3e3;border-radius:5px;flex:1 0 auto;list-style:none;margin:25px auto;padding:12px;text-align:center;width:100%}.formkit-form .formkit-alert:empty{display:none}.formkit-form .formkit-alert-success{background:#d3fbeb;border-color:#10bf7a;color:#0c905c}.formkit-form .formkit-alert-error{background:#fde8e2;border-color:#f2643b;color:#ea4110}.formkit-form .formkit-spinner{display:flex;height:0;width:0;margin:0 auto;position:absolute;top:0;left:0;right:0;overflow:hidden;text-align:center;transition:all .3s ease-in-out}.formkit-form .formkit-spinner>div{margin:auto;width:12px;height:12px;background-color:#fff;opacity:.3;border-radius:100%;display:inline-block;-webkit-animation:formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd- 1.4s ease-in-out infinite both;animation:formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd- 1.4s ease-in-out infinite both}.formkit-form .formkit-spinner>div:first-child{-webkit-animation-delay:-.32s;animation-delay:-.32s}.formkit-form .formkit-spinner>div:nth-child(2){-webkit-animation-delay:-.16s;animation-delay:-.16s}.formkit-form .formkit-submit[data-active] .formkit-spinner{opacity:1;height:100%;width:50px}.formkit-form .formkit-submit[data-active] .formkit-spinner~span{opacity:0}@-webkit-keyframes formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd-{0%,80%,to{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd-{0%,80%,to{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}.formkit-form{box-shadow:0 2px 15px 0 rgba(210,214,220,.5);max-width:700px;overflow:hidden}.formkit-form [data-style=full]{width:100%;display:block}.formkit-form .formkit-header{margin-top:0;margin-bottom:20px;font-family:inherit}.formkit-form .formkit-subheader{margin:15px 0}.formkit-form .formkit-column{background-size:cover;background-repeat:no-repeat;background-position:50%;padding:20px}.formkit-form .formkit-column:nth-child(2){border-top:1px solid #e9ecef}.formkit-form .formkit-field{margin:0 0 15px}.formkit-form .formkit-input,.formkit-form .formkit-submit{width:100%}.formkit-form .formkit-guarantee{font-size:13px;margin:0 0 15px}.formkit-form .formkit-guarantee>p{margin:0}.formkit-form .formkit-powered-by{color:#7d7d7d;display:block;font-size:12px;margin-bottom:0;text-align:center}.formkit-form .formkit-powered-by[data-active=false]{opacity:.5}.formkit-form[min-width~="600"] [data-style=full],.formkit-form[min-width~="700"] [data-style=full],.formkit-form[min-width~="800"] [data-style=full]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}.formkit-form[min-width~="600"] .formkit-submit,.formkit-form[min-width~="700"] .formkit-submit,.formkit-form[min-width~="800"] .formkit-submit{width:auto}.formkit-form[min-width~="600"] .formkit-column,.formkit-form[min-width~="700"] .formkit-column,.formkit-form[min-width~="800"] .formkit-column{padding:40px}.formkit-form[min-width~="600"] .formkit-column:nth-child(2),.formkit-form[min-width~="700"] .formkit-column:nth-child(2),.formkit-form[min-width~="800"] .formkit-column:nth-child(2){border-top:none}</style><meta name="generator" content="Gatsby 2.0.91"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" title="Dan Abramov&#x27;s Overreacted Blog RSS Feed" href="/Personal-Blog/rss.xml"/><link rel="shortcut icon" href="/Personal-Blog/icons/icon-48x48.png"/><link rel="manifest" href="/Personal-Blog/manifest.webmanifest"/><title data-react-helmet="true">En quoi les fonctions composants sont-elles différentes des classes ? — Overreacted</title><meta data-react-helmet="true" name="theme-color" content="#282c35"/><meta data-react-helmet="true" name="description" content="C’est un genre de Pokémon complètement différent."/><meta data-react-helmet="true" property="og:url" content="https://yusufunlu.github.io/Personal-Blog//fr/how-are-function-components-different-from-classes/"/><meta data-react-helmet="true" property="og:title" content="En quoi les fonctions composants sont-elles différentes des classes ?"/><meta data-react-helmet="true" property="og:description" content="C’est un genre de Pokémon complètement différent."/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@dan_abramov"/><meta data-react-helmet="true" name="twitter:title" content="En quoi les fonctions composants sont-elles différentes des classes ?"/><meta data-react-helmet="true" name="twitter:description" content="C’est un genre de Pokémon complètement différent."/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:inherit;font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);border-left-color:inherit;opacity:0.8;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:var(--textLink);text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}p code{font-size:1rem;}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}blockquote.translation{font-size:1em;}</style><link as="script" rel="preload" href="/Personal-Blog/component---src-templates-blog-post-js-ef2898a2e81c47683f5b.js"/><link as="script" rel="preload" href="/Personal-Blog/app-198cd55e69a6a03b3f73.js"/><link as="script" rel="preload" href="/Personal-Blog/0-b197e8c6c7ff26484233.js"/><link as="script" rel="preload" href="/Personal-Blog/2-469c709c476faea7103a.js"/><link as="script" rel="preload" href="/Personal-Blog/1-1b550cd61a5e170131aa.js"/><link as="script" rel="preload" href="/Personal-Blog/webpack-runtime-816b037bee21ad2c738f.js"/><link as="fetch" rel="preload" href="/Personal-Blog/static/d/148/path---fr-how-are-function-components-different-from-classes-aa-8-73c-HsnVbI4KDnI2UR8mXpDieJMLEg.json" crossorigin="use-credentials"/></head><body class="light"><script>
              (function() {
                window.__onThemeChange = function() {};
                function setTheme(newTheme) {
                  window.__theme = newTheme;
                  preferredTheme = newTheme;
                  document.body.className = newTheme;
                  window.__onThemeChange(newTheme);
                }

                var preferredTheme;
                try {
                  preferredTheme = localStorage.getItem('theme');
                } catch (err) { }

                window.__setPreferredTheme = function(newTheme) {
                  setTheme(newTheme);
                  try {
                    localStorage.setItem('theme', newTheme);
                  } catch (err) {}
                }

                var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
                darkQuery.addListener(function(e) {
                  window.__setPreferredTheme(e.matches ? 'dark' : 'light')
                });

                setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
              })();
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div style="color:var(--textNormal);background:var(--bg);transition:color 0.2s ease-out, background 0.2s ease-out;min-height:100vh"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2.625rem"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;margin-bottom:0;height:42px;line-height:2.625rem"><a style="box-shadow:none;text-decoration:none;color:rgb(255, 167, 196)" href="/Personal-Blog/">Overreacted</a></h3><div style="height:24px"></div></header><main><article><header><h1 style="color:var(--textTitle)">En quoi les fonctions composants sont-elles différentes des classes ?</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.4rem">March 3, 2019<!-- --> • ☕️☕️☕️ 16 min read</p><div class="translations"><p style="font-size:0.9em;border:1px solid var(--hr);border-radius:0.75em;padding:0.75em;background:var(--inlineCode-bg);word-break:keep-all;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"><span><span>Translated by readers into: </span><a href="/Personal-Blog/es/how-are-function-components-different-from-classes/">Español</a> • <b>Français</b> • <a href="/Personal-Blog/pt-br/how-are-function-components-different-from-classes/">Português do Brasil</a> • <a href="/Personal-Blog/ja/how-are-function-components-different-from-classes/">日本語</a> • <a href="/Personal-Blog/ko/how-are-function-components-different-from-classes/">한국어</a></span><br/><br/><a href="/Personal-Blog/how-are-function-components-different-from-classes/">Read the original</a> • <a href="https://github.com/gaearon/overreacted.io/edit/master/src/pages/how-are-function-components-different-from-classes/index.fr.md" target="_blank" rel="noopener noreferrer">Improve this translation</a> • <a href="/Personal-Blog/fr">View all translated posts</a> </p></div></header><div><p>Quelles sont les différences entre les fonctions composants et les classes React ?</p>
<p>Pendant longtemps, la réponse canonique affirmait que les classes donnent accès à davantage de fonctionnalités (telles que l’état local).  Mais avec les <a href="https://fr.reactjs.org/docs/hooks-intro.html" target="_blank" rel="nofollow noopener noreferrer">Hooks</a>, ça n’est plus vrai.</p>
<p>Vous avez peut-être entendu dire que l’un ou l’autre offre de meilleures performances.  Mais lequel ?  La plupart des comparaisons sont <a href="https://medium.com/@dan_abramov/this-benchmark-is-indeed-flawed-c3d6b5b6f97f" target="_blank" rel="nofollow noopener noreferrer">faussées</a> aussi j’éviterais de <a href="https://github.com/ryardley/hooks-perf-issues/pull/2" target="_blank" rel="nofollow noopener noreferrer">tirer des conclusions hâtives</a> en les lisant.  Les performances découlent surtout de ce que fait votre code, bien plus que du fait que vous ayez opté pour une fonction ou une classe.  D’après ce que nous avons pu voir, les différences de performances sont négligeables, même si les stratégies d’optimisation sont un peu <a href="https://reactjs.org/docs/hooks-faq.html#are-hooks-slow-because-of-creating-functions-in-render" target="_blank" rel="nofollow noopener noreferrer">différentes</a>.</p>
<p>En tous cas, nous <a href="https://fr.reactjs.org/docs/hooks-faq.html#should-i-use-hooks-classes-or-a-mix-of-both" target="_blank" rel="nofollow noopener noreferrer">déconseillons</a> de ré-écrire vos composants existants à moins que vous n’ayez d’autres raisons de le faire et soyez à l’aise à l’idée de faire partie des premiers utilisateurs. Les Hooks sont encore tout neufs (comme React l’était en 2014), et certaines « meilleures pratiques » ne figurent pas encore dans les tutoriels.</p>
<p>Ce qui nous amène où, exactement ?  Y a-t-il la moindre différence fondamentale entre les fonctions et les classes React, finalement ?  Bien sûr qu’il y en a—en termes de modèle mental. <strong>Dans cet article, je vais parler de la plus importante différence entre eux.</strong>  Elle était déjà là lorsque les fonctions composants sont <a href="https://fr.reactjs.org/blog/2015/09/10/react-v0.14-rc1.html#stateless-function-components" target="_blank" rel="nofollow noopener noreferrer">arrivées</a> en 2015, mais on a tendance à l’oublier :</p>
<blockquote>
<p><strong>Les fonctions composants capturent les valeurs du rendu.</strong></p>
</blockquote>
<p>Décortiquons ce que j’entends par là.</p>
<hr>
<p><strong>Remarque : cet article ne porte aucun jugement de valeur sur les classes ou les fonctions.  Je me contente de décrire la différence entre les deux modèles de programmation en React.  Si vous avez des questions au sujet de l’adoption croissante des fonctions, je vous invite à consulter la <a href="https://fr.reactjs.org/docs/hooks-faq.html#adoption-strategy" target="_blank" rel="nofollow noopener noreferrer">FAQ des Hooks</a>.</strong></p>
<hr>
<p>Prenons ce composant :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">ProfilePage</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Il affiche un bouton qui simule une requête réseau avec <code class="language-text">setTimeout</code> puis affiche un message de confirmation.  Par exemple, si <code class="language-text">props.user</code> est <code class="language-text">&#39;Dan&#39;</code>, il affichera <code class="language-text">&#39;Vous suivez désormais Dans&#39;</code> après trois secondes.  Simple comme tout.</p>
<p><em>(Notez au passage que cet exemple pourrait tout aussi bien utiliser des déclarations de fonctions. <code class="language-text">function handleClick()</code> fonctionnerait exactement pareil.)</em></p>
<p>Comment écrire ça avec une classe ?  Une transcription naïve pourrait ressembler à ça :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>On pense généralement que ces deux exemples de code sont équivalents.  Il est fréquent qu’on refactorise librement d’une approche à l’autre sans en remarquer les implications :</p>
<p><img src="/Personal-Blog/wtf-1d3c7a341ee3fcadc79df00e7d872e4b.gif" alt="Cherchez la différence entre ces deux versions"></p>
<p><strong>Et pourtant, ces deux morceaux de code ont une différence subtile.</strong>  Regardez-les bien.  Avez-vous repéré la différence ?  Personnellement, ça m’a pris pas mal de temps pour m’en rendre compte.</p>
<p><strong>Les <em>spoilers</em> (ou <em>divulgâcheurs</em>, comme le disent magnifiquement nos amis Québecois) arrivent, alors voici déjà une <a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="nofollow noopener noreferrer">démo interactive</a> si vous voulez essayer de trouver par vous-même.</strong> Le reste de cet article explique la différence et illustre en quoi elle est importante.</p>
<hr>
<p>Avant de continuer, j’aimerais insister sur le fait que la différence que je décris n’a rien à voir avec les Hooks React.  Les exemples ci-dessus n’utilisent même pas les Hooks !</p>
<p>Il s’agit avant tout de la différence entre les fonctions et les classes en React.  Si vous avez l’intention d’utiliser plus souvent les fonctions dans une appli React, vous voudrez sans doute bien comprendre ça.</p>
<hr>
<p><strong>Mettons la différence en évidence avec un bug fréquent dans les applications React.</strong></p>
<p>Ouvrez cette <strong><a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="nofollow noopener noreferrer"><em>sandbox</em> d’exemple</a></strong> avec un sélecteur de profil actif et les deux implémentations de <code class="language-text">ProfilePage</code> vues ci-dessus, chacune affichant un bouton <em>Follow</em>.</p>
<p>Essayez cette séquence d’actions pour chaque bouton :</p>
<ol>
<li><strong>Cliquez</strong> sur un des boutons <em>Follow</em>.</li>
<li><strong>Changez</strong> le profil sélectionné en moins de 3 secondes.</li>
<li><strong>Lisez</strong> le texte de l’alerte.</li>
</ol>
<p>Vous remarquerez une différence originale :</p>
<ul>
<li>
<p>Avec la <strong>fonction</strong> <code class="language-text">ProfilePage</code> du bouton du haut, cliquer <em>Follow</em> sur le profil de Dan puis choisir le profil de Sophie affichera tout de même <code class="language-text">&#39;Followed Dan&#39;</code>.</p>
</li>
<li>
<p>Avec la <strong>classe</strong> <code class="language-text">ProfilePage</code> du bouton du bas, ça afficherait <code class="language-text">&#39;Followed Sophie&#39;</code> :</p>
</li>
</ul>
<p><img src="/Personal-Blog/bug-386a449110202d5140d67336a0ade5a0.gif" alt="Démonstration des étapes"></p>
<hr>
<p>Dans cet exemple, c’est le premier comportement qui a raison.  <strong>Si nous suivons une personne puis navigons sur le profil d’une autre, mon composant ne devrait pas s’emmêler les pinceaux quant à la personne que j’ai suivie.</strong>  L’implémentation à base de classe est clairement défectueuse.</p>
<p><em>(Ceci étant dit, vous devriez carrément <a href="https://mobile.twitter.com/sophiebits" target="_blank" rel="nofollow noopener noreferrer">suivre Sophie</a>.)</em></p>
<hr>
<p>Alors pourquoi notre exemple à base de classe se comporte-t-il ainsi ?</p>
<p>Examinons de plus près la méthode <code class="language-text">showMessage</code> de notre classe :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Cette méthode de classe lit l’info dans <code class="language-text">this.props.user</code>.  Les props sont immuables en React donc elles ne peuvent jamais changer.  <strong>En revanche, <code class="language-text">this</code> est (et a toujours été) modifiable.</strong></p>
<p>En fait, c’est l’objectif-même de <code class="language-text">this</code> dans une classe.  React lui-même le modifie au fil du temps pour que vous puissiez en lire une version à jour dans <code class="language-text">render</code> et les méthodes de cycle de vie.</p>
<p>Du coup si notre composant refait un rendu pendant que la requête est en cours, <code class="language-text">this.props</code> va changer.  La méthode <code class="language-text">showMessage</code> lit <code class="language-text">user</code> depuis des <code class="language-text">props</code> « trop récentes ».</p>
<p>Ça met en lumière une question intéressante sur la nature des interfaces utilisateurs (UI).  Si nous estimons qu’une UI est conceptuellement une fonction de l’état applicatif courant, <strong>les gestionnaires d’événements font partie du résultat du rendu, au même titre que la sortie visuelle.</strong>  Nos gestionnaires d’événements « appartiennent » à un rendu particulier, avec ses props et son état local spécifiques.</p>
<p>Seulement voilà, différer une fonction de rappel qui lira <code class="language-text">this.props</code> rompt cette association.  Notre fonction de rappel <code class="language-text">showMessage</code> n’est pas « liée » à un rendu particulier, de sorte qu’elle « perd » les props idoines.  En lisant <code class="language-text">this</code>, nous avons coupé la connexion.</p>
<hr>
<p><strong>Imaginons que les fonctions composants n’existent pas.</strong>  Comment résoudrions-nous ce problème ?</p>
<p>On voudrait en quelque sorte « réparer » le lien entre le <code class="language-text">render</code> doté des bonnes props et la fonction de rappel <code class="language-text">showMessage</code> qui les lira.  Les <code class="language-text">props</code> se perdent en chemin.</p>
<p>Une façon de faire consisterait à lire <code class="language-text">this.props</code> tôt dans le gestionnaire, puis à les passer explicitement à la fonction exécutée en différé :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span>user<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span></span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showMessage</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Ça <a href="https://codesandbox.io/s/3q737pw8lq" target="_blank" rel="nofollow noopener noreferrer">marche</a>.  Mais cette approche est significativement plus verbeuse et porte un risque d’erreurs qui ne fera que croître avec le temps.  Et si on a besoin de plus d’une prop ?  Et si on a aussi besoin de l’état local ?  <strong>Si <code class="language-text">showMessage</code> appelle une autre méthode, et que cette méthode lit <code class="language-text">this.props.something</code> ou <code class="language-text">this.state.something</code>, on reviendra au point de départ.</strong>  On aurait besoin de passer <code class="language-text">this.props</code> et <code class="language-text">this.state</code> en arguments à chaque méthode appelée depuis <code class="language-text">showMessage</code>.</p>
<p>Ça irait <em>a contrario</em> de l’ergonomie de base d’une classe.  C’est par ailleurs difficile à se rappeler et à garantir, d’où la tendance de certaines personnes à plutôt accepter les bugs comme une fatalité.</p>
<p>Dans le même esprit, placer le code appelant <code class="language-text">alert</code> à la volée dans <code class="language-text">handleClick</code> ne résout pas le problème général.  Nous voulons structurer le code d’une façon qui permette la découpe en plusieurs méthodes <em>mais</em> qui autorise aussi la lecture des props et de l’état local qui étaient en vigueur lors du rendu déclencheur.  <strong>Ce problème n’est même pas spécifique à React : vous pouvez le reproduire dans n’importe quelle bibliothèque UI qui place ses données dans un objet modifiable tel que <code class="language-text">this</code>.</strong></p>
<p>Peut-être qu’on pourrait <em>lier</em> les méthodes dans le constructeur ?</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>showMessage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>showMessage<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span>

  <span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Non, ça ne change rien.  Rappelez-vous, le problème c’est qu’on lit <code class="language-text">this.props</code> trop tard, ce n’est pas une histoire de syntaxe ! <strong>Ceci dit, le problème disparaîtrait si nous nous basions entièrement sur les fermetures lexicales <em>(closures, NdT)</em> JavaScript.</strong></p>
<p>On évite souvent les fermetures lexicales parce qu’il est <a href="https://wsvincent.com/javascript-closure-settimeout-for-loop/" target="_blank" rel="nofollow noopener noreferrer">difficile</a> de réfléchir à une valeur qui peut bouger dans le temps.  Mais en React, les props et l’état sont immuables !  (En tout cas, nous le recommandons fortement.)  Ça réduit considérablement les risques de nous tirer une balle dans le pied.</p>
<p>Ça signifie que si vous réalisez une fermeture lexicale sur les props ou l’état local d’un rendu donné, vous pouvez être sûr·e qu’elles ne bougeront pas :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token comment">// Capturons les props !</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span></span>
    <span class="token comment">// Remarque : on est *dans render*, pas dans d’autres méthodes de la classe.</span>
    <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>Vous avez « capturé » les props au moment du rendu :</strong></p>
<p><img src="/Personal-Blog/pokemon-fa483dd5699aac1350c57591770a49be.gif" alt="Capture d’un Pokemon"></p>
<p>De cette façon, tout code à l’intérieur du rendu (y compris <code class="language-text">showMessage</code>) a la certitude de voir les props de ce rendu spécifique.  React cesse de « piquer notre fromage ».</p>
<p><strong>On peut alors ajouter autant de fonctions utilitaires qu’on veut à l’intérieur, elles pourraient toutes utiliser les props et l’état local capturés.</strong>  Les fermetures lexicales à la rescousse !</p>
<hr>
<p>L’<a href="https://codesandbox.io/s/oqxy9m7om5" target="_blank" rel="nofollow noopener noreferrer">exemple ci-dessus</a> est juste mais a une drôle de tête.  À quoi sert-il d’avoir une classe si on définit les fonctions dans <code class="language-text">render</code> au lieu d’utiliser des méthodes de classe ?</p>
<p>Eh bien oui, on pourrait simplement virer le « squelette » de classe autour :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">ProfilePage</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Comme dans la version précédente, les <code class="language-text">props</code> sont capturées : React les passe en argument.  <strong>Contrairement à <code class="language-text">this</code>, l’objet <code class="language-text">props</code> lui-même n’est jamais modifié par React.</strong></p>
<p>C’est encore plus évident si on déstructure <code class="language-text">props</code> dans la signature de la fonction :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="gatsby-highlight-code-line"><span class="token keyword">function</span> <span class="token function">ProfilePage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> user <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous suivez désormais '</span> <span class="token operator">+</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Suivre</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Quand le composant parent affiche <code class="language-text">ProfilePage</code> avec des props différentes, React rappellera la fonction <code class="language-text">ProfilePage</code>.  Mais le gestionnaire d’événements qui a réagi à notre clic « appartenait » au rendu précédent, avec sa propre valeur de <code class="language-text">user</code> et son <code class="language-text">showMessage</code> qui la lit.  Ils restent intacts.</p>
<p>C’est pourquoi, dans la version basée fonction de <a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="nofollow noopener noreferrer">cette démo</a>, cliquer <em>Follow</em> sur le profil de Sophie puis sélectionner rapidement Sunil afficherait quand même <code class="language-text">&#39;Followed Sophie&#39;</code> :</p>
<p><img src="/Personal-Blog/fix-84396c4b3982827bead96912a947904e.gif" alt="Démo du comportement correct"></p>
<p>Ce comportement est le bon. <em>(Même si vous voudrez peut-être <a href="https://mobile.twitter.com/threepointone" target="_blank" rel="nofollow noopener noreferrer">suivre Sunil</a> aussi !)</em></p>
<hr>
<p>Nous comprenons à présent la différence majeure entre les fonctions et les classes en React :</p>
<blockquote>
<p><strong>Les fonctions composants capturent les valeurs du rendu.</strong></p>
</blockquote>
<p><strong>Avec les Hooks, le même principe s’applique aussi à l’état.</strong>  Prenez cet exemple :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MessageThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous avez dit : '</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSendClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleMessageChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleMessageChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSendClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Envoyer</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>(Voici une <a href="https://codesandbox.io/s/93m5mz9w24" target="_blank" rel="nofollow noopener noreferrer">démo interactive</a>.)</p>
<p>Ça ne casse pas des briques comme UI de messagerie, mais ça permet d’illustrer le même aspect : si j’envoie un message donné, le composant ne devrait pas s’emmêler les pinceaux quant au message qui est effectivement parti.  La variable <code class="language-text">message</code> de la fonction composant capture l’état qui « appartient » au rendu ayant produit le gestionnaire d’événement appelé par le navigateur.  Ainsi <code class="language-text">message</code> conserve la valeur qu’avait le champ quand j’ai cliqué sur « Envoyer ».</p>
<hr>
<p>On a compris que les fonctions en React capturent les props et l’état local par défaut. <strong>Mais comment faire si nous <em>voulons</em> lire des props ou un état qui n’appartiennent pas à ce rendu spécifique ?</strong>  Et si nous voulions <a href="https://dev.to/scastiel/react-hooks-get-the-current-state-back-to-the-future-3op2" target="_blank" rel="nofollow noopener noreferrer">« lire dans l’avenir »</a> ?</p>
<p>Avec les classes, il suffit de lire <code class="language-text">this.props</code> ou <code class="language-text">this.state</code> parce que <code class="language-text">this</code> est lui-même modifiable.  React le modifie.  Dans les fonctions composants, il est également possible d’avoir une valeur modifiable partagée par tous les rendus du composant.  Ça s’appelle une « ref » :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Vous pouvez lire et écrire `ref.current`.</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Ceci dit, vous devrez la gérer vous-même.</p>
<p>Une ref <a href="https://fr.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables" target="_blank" rel="nofollow noopener noreferrer">remplit le même rôle</a> qu’un champ d’instance.  C’est une échappatoire vers un monde impératif et modifiable.  Vous avez peut-être l’habitude des « refs DOM », mais ici le concept est beaucoup plus général.  C’est juste une boîte dans laquelle vous pouvez mettre des trucs.</p>
<p>Même visuellement, <code class="language-text">this.something</code> est comme un reflet de <code class="language-text">something.current</code> dans un miroir.  Ils représentent le même concept.</p>
<p>Par défaut, React ne crée pas de refs pour les derniers props et état local en date des composants fonctions.  Vous n’en avez presque jamais besoin, donc les prédéfinir serait un gâchis de ressources.  Ceci dit, vous pouvez pister manuellement une valeur si le cœur vous en dit :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MessageThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> latestMessage <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous avez dit : '</span> <span class="token operator">+</span> latestMessage<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSendClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleMessageChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">    latestMessage<span class="token punctuation">.</span>current <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Si nous lisions <code class="language-text">message</code> dans <code class="language-text">showMessage</code>, nous verrions le message au moment où nous avions pressé le bouton Envoyer.  Mais nous le lisons depuis <code class="language-text">latestMessage.current</code>, donc nous obtenons la dernière valeur inscrite—même si nous avons continué à taper après avoir pressé le bouton d’envoi.</p>
<p>Vous pouvez comparer les <a href="https://codesandbox.io/s/93m5mz9w24" target="_blank" rel="nofollow noopener noreferrer">deux</a> <a href="https://codesandbox.io/s/ox200vw8k9" target="_blank" rel="nofollow noopener noreferrer">démos</a> pour bien vous rendre compte de la différence.  Une ref est un moyen de « laisser tomber » la cohérence de rendu, ce qui s’avère parfois utile.</p>
<p>En règle générale, vous devriez éviter de lire ou d’écrire des refs <em>pendant</em> le rendu, parce qu’elles sont modifiables.  On préfère avoir des rendus prévisibles.  <strong>Toutefois, si nous voulons accéder à la valeur la plus récente d’une prop ou d’une variable d’état donnée, mettre à jour la ref manuellement est fastidieux.</strong>  On pourrait l’automatiser en utilisant un effet :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">MessageThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token comment">// Garde trace de la dernière valeur saisie</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> latestMessage <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    latestMessage<span class="token punctuation">.</span>current <span class="token operator">=</span> message<span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vous avez dit : '</span> <span class="token operator">+</span> latestMessage<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>(Voici une <a href="https://codesandbox.io/s/yqmnz7xy8x" target="_blank" rel="nofollow noopener noreferrer">démo</a>.)</p>
<p>Nous affectons la ref <em>dans</em> un effet afin que la valeur de la ref ne change qu’après la mise à jour du DOM.  Ça garantit que notre mutation ne viendra pas casser des fonctionnalités comme <a href="https://fr.reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html" target="_blank" rel="nofollow noopener noreferrer">la découpe temporelle et Suspense</a>, qui reposent sur la capacité à interrompre les rendus.</p>
<p>Il est assez rare de devoir utiliser un ref ainsi.  <strong>Capturer les props et l’état est en général une meilleure approche, donc celle par défaut.</strong>  Néanmoins, ça peut être utile pour interagir avec des <a href="/Personal-Blog/making-setinterval-declarative-with-react-hooks/">API impératives</a> comme les horloges et les abonnements. Rappelez-vous que vous pouvez pister <em>n’importe quelle</em> valeur de cette façon : une prop, une variable d’état, l’objet de props tout entier, ou même une fonction.</p>
<p>C’est également pratique pour des optimisations, comme lorsque l’identité de <code class="language-text">useCallback</code> change trop souvent.  Ceci dit, <a href="https://fr.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down" target="_blank" rel="nofollow noopener noreferrer">utiliser un réducteur</a> constitue souvent une <a href="https://github.com/ryardley/hooks-perf-issues/pull/3" target="_blank" rel="nofollow noopener noreferrer">meilleure solution</a>. (Ce sera pour un autre article !)</p>
<hr>
<p>Dans cet article, nous avons examiné des approches défectueuses fréquentes dans les classes, et vu comment les fermetures lexicales nous aident à les corriger.  Pourtant, vous avez peut-être remarqué que lorsque nous essayons d’optimiser les Hooks en précisant un tableau de dépendances, nous avons parfois des problèmes en raisons de fermetures lexicales obsolètes.  Est-ce que ça veut dire que les fermetures lexicales sont un problème ?  Je ne le pense pas.</p>
<p>Comme nous l’avons vu plus haut, elles nous aident en fait à <em>corriger</em> les problèmes subtils qu’on a souvent du mal à remarquer.  Dans la même veine, elles facilitent grandement l’écriture de code qui fonctionne correctement en <a href="https://fr.reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html" target="_blank" rel="nofollow noopener noreferrer">Mode Concurrent</a>.  Tout ça est possible parce que la logique à l’intérieur du composant lit les props et l’état corrects depuis la fermeture lexicale associée au bon rendu.</p>
<p>Dans tous les cas que j’ai pu examiner jusqu’ici, <strong>les problèmes de « fermeture lexicale obsolète » étaient dus à la supposition incorrecte que « les fonctions ne changent pas » ou que « les props sont toujours les mêmes ».</strong>  Ce n’est pas le cas, comme j’espère l’avoir clarifié ici.</p>
<p>Les fonctions créent une fermeture lexicale sur leurs props et leur état local, de sorte que leur identité est tout aussi importante.  Ce n’est pas un bug, mais une fonctionnalité des fonctions composants.  Les fonctions ne devraient pas être exclues du « tableau des dépendances » de <code class="language-text">useEffect</code> ou <code class="language-text">useCallback</code>, par exemple.  (Le meilleur correctif consiste généralement à utiliser <code class="language-text">useReducer</code>, ou la solution à base de <code class="language-text">useRef</code> vue plus haut, et nous documenterons prochainement sur quels critères opter pour l’une ou l’autre.)</p>
<p>Quand nous écrivons la majorité de notre code React sous forme de fonctions, nous devons ajuster notre intuition quant à <a href="https://github.com/ryardley/hooks-perf-issues/pull/3" target="_blank" rel="nofollow noopener noreferrer">l’optimisation du code</a> et <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="nofollow noopener noreferrer">les types de valeurs qui peuvent changer au fil du temps</a>.</p>
<p>Comme <a href="https://mobile.twitter.com/EphemeralCircle/status/1099095063223812096" target="_blank" rel="nofollow noopener noreferrer">l’a si bien dit Fredrik</a> :</p>
<blockquote>
<p>La meilleure règle mentale que j’ai pu trouver jusqu’ici avec les hooks, c’est qu’on devrait « coder comme si n’importe quelle valeur était susceptible de changer avec le temps ».</p>
</blockquote>
<p>Les fonctions ne font pas exception à cette règle.  Ça prendra du temps pour que la majorité des supports d’apprentissage de React abordent ce point.  Ça nécessite quelques ajustements à notre modèle mental basé sur les classes.  Mais j’espère que cet article vous aura aidé à considérer tout ça d’un regard neuf.</p>
<p>Les fonctions React capturent toujours leurs valeurs—et désormais nous savons pourquoi.</p>
<p><img src="/Personal-Blog/pikachu-fc3bddf6d4ca14bc77917ac0cfad3608.gif" alt="Pikachu qui sourit"></p>
<p>Elles sont un genre de Pokémon complètement différent.</p></div><footer><p><a href="https://mobile.twitter.com/search?q=https%3A%2F%2Fyusufunlu.github.io%2FPersonal-Blog%2F%2Fhow-are-function-components-different-from-classes%2F" target="_blank" rel="noopener noreferrer">Discuss on Twitter</a> • <a href="https://github.com/gaearon/overreacted.io/edit/master/src/pages/how-are-function-components-different-from-classes/index.fr.md" target="_blank" rel="noopener noreferrer">Edit on GitHub</a></p></footer></article></main><aside><div style="margin:90px 0 40px 0;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"><form action="https://app.convertkit.com/forms/812047/subscriptions" class="seva-form formkit-form" method="post" min-width="400 500 600 700 800" style="background-color:rgb(255, 255, 255);border-radius:6px"><div data-style="full"><div data-element="column" class="formkit-column" style="background-color:rgb(249, 250, 251)"><h1 class="formkit-header" data-element="header" style="color:rgb(77, 77, 77);font-size:20px;font-weight:700">Join the Newsletter</h1><div data-element="subheader" class="formkit-subheader" style="color:rgb(104, 104, 104)"><p>Subscribe to get my latest content by email.</p></div><div class="formkit-image"><svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" viewBox="0 0 46 46" style="max-width:100%"><g fill="none" fill-rule="evenodd"><path fill="#DD92AB" d="M23,36 C22.813,36 22.627,35.948 22.463,35.844 L0.463,21.844 C0.159,21.651 -0.017,21.308 0.001,20.948 C0.02,20.589 0.23,20.266 0.553,20.105 L23,6 L45.447,20.105 C45.769,20.266 45.98,20.588 45.999,20.948 C46.018,21.308 45.841,21.65 45.537,21.844 L23.537,35.844 C23.373,35.948 23.187,36 23,36 Z"></path><path fill="#FFF" d="M38,37 L8,37 L8,1 C8,0.448 8.448,0 9,0 L37,0 C37.552,0 38,0.448 38,1 L38,37 Z"></path><path fill="#FFA7C4" d="M45,46 C44.916,46 44.831,45.989 44.748,45.968 L21.748,39.968 L22,33 L46,21 L46,45 C46,45.31 45.856,45.602 45.611,45.792 C45.435,45.928 45.219,46 45,46 Z"></path><path fill="#FFC3D7" d="M45,46 L1,46 C0.447,46 0,45.552 0,45 L0,21 L45.479,44.122 C45.88,44.341 46.083,44.804 45.969,45.247 C45.856,45.69 45.457,46 45,46 Z"></path><path fill="#FFA7C4" d="M19 20.414L14.293 15.707C13.902 15.316 13.902 14.684 14.293 14.293L19 9.586 20.414 11 16.414 15 20.414 19 19 20.414zM27 20.414L25.586 19 29.586 15 25.586 11 27 9.586 31.707 14.293C32.098 14.684 32.098 15.316 31.707 15.707L27 20.414z"></path></g></svg></div></div><div data-element="column" class="formkit-column"><ul class="formkit-alert formkit-alert-error" data-element="errors" data-group="alert"></ul><div data-element="fields" class="seva-fields formkit-fields"><div class="formkit-field"><input type="text" class="formkit-input" aria-label="Your first name" name="fields[first_name]" placeholder="Your first name" style="border-color:rgb(227, 227, 227);border-radius:4px;color:rgb(0, 0, 0);font-weight:400"/></div><div class="formkit-field"><input type="email" class="formkit-input" name="email_address" aria-label="Your email address" placeholder="Your email address" style="border-color:rgb(227, 227, 227);border-radius:4px;color:rgb(0, 0, 0);font-weight:400"/></div><button data-element="submit" class="formkit-submit formkit-submit" style="background-color:hsl(340, 63%, 55%);border-radius:24px;color:white;font-weight:700"><div class="formkit-spinner"></div><span>Subscribe</span></button></div><div data-element="guarantee" class="formkit-guarantee" style="color:rgb(77, 77, 77);font-size:13px;font-weight:400"><p>I won’t send you spam.</p><p>Unsubscribe at <em>any</em> time.</p></div></div></div></form></div><h3 style="font-family:Montserrat, sans-serif;margin-top:0.4375rem"><a style="box-shadow:none;text-decoration:none;color:var(--pink)" href="/Personal-Blog/">Overreacted</a></h3><div style="display:flex;margin-bottom:3.5rem"><img src="/Personal-Blog/static/profile-pic-69c77131fd248a7aaaf26fab021f469f.png" alt="Yusuf Unlu" style="margin-right:0.875rem;margin-bottom:0;height:3.5rem;border-radius:50%"/><p style="max-width:310px">Personal blog by <a href="https://mobile.twitter.com/yufusunlu">Yusuf Unlu</a>.<!-- --> <!-- -->I explain with words and code.</p></div><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li></li><li></li></ul></nav></aside></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-130227707-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"fr-how-are-function-components-different-from-classes-aa8","path":"/fr/how-are-function-components-different-from-classes/"};window.dataPath="148/path---fr-how-are-function-components-different-from-classes-aa-8-73c-HsnVbI4KDnI2UR8mXpDieJMLEg";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-198cd55e69a6a03b3f73.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-1d061c91bf8b4d1ed13d.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.77da55083c18bdb7fbef.css","/component---src-templates-blog-post-js-ef2898a2e81c47683f5b.js"],"component---src-pages-404-js":["/component---src-pages-404-js.fd288bb02445d10643fa.css","/component---src-pages-404-js-b3cd5f330471999955d6.js"],"component---src-pages-confirm-js":["/component---src-pages-confirm-js.fd288bb02445d10643fa.css","/component---src-pages-confirm-js-009d25afd727cbb30f51.js"],"component---src-pages-thanks-js":["/component---src-pages-thanks-js.fd288bb02445d10643fa.css","/component---src-pages-thanks-js-8fa56c06867d62f44f13.js"],"pages-manifest":["/pages-manifest-39a0dca89e16fd875f78.js"]};/*]]>*/</script><script src="/Personal-Blog/webpack-runtime-816b037bee21ad2c738f.js" async=""></script><script src="/Personal-Blog/1-1b550cd61a5e170131aa.js" async=""></script><script src="/Personal-Blog/2-469c709c476faea7103a.js" async=""></script><script src="/Personal-Blog/0-b197e8c6c7ff26484233.js" async=""></script><script src="/Personal-Blog/app-198cd55e69a6a03b3f73.js" async=""></script><script src="/Personal-Blog/component---src-templates-blog-post-js-ef2898a2e81c47683f5b.js" async=""></script></body></html>